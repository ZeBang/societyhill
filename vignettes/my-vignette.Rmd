---
title: "TenTS Package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{my-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Factor and Autoregressive Models for Tensor Time Series

The R package **TenTS** includes methods in our recent papers, including [Factor Models](https://arxiv.org/abs/1905.07530) and [Autoregressive Models](https://arxiv.org/abs/1812.08916) for High-Dimensional tensor Time Series. We demonstrate some examples for how to use our package here. To have more details please see the manual file for the full documentation.

## Installation

Temporarily, we use GitHub to host this package source code then users can install the package directly from GitHub using the `install_github` function in the [devtools](https://github.com/r-lib/devtools#readme) package:
```{r, eval=FALSE}
library(devtools)
install_github("zebang/tensorTS")
```

Remark: You may need download latest [Rtools](https://cran.r-project.org/bin/windows/Rtools/) if error message says so.

## Autoregressive Models

We collect all estimation methods in one function `TAR`. So you can just use this single function to have all estimation methods you want to use.

For demonstration, we first randomly generate some coefficient matrices and tensor time series as follows,
```{r}
library(timeFA)
dim <- c(4,5,6) # dimension of tensor at time t is 2 * 2 * 2
A <- generateA(dim, R=1) # randomly generate coefficient matrices with number of terms R = 1
xx <- generate(A, t=100) # generate tensor time series with AR(1) structure
```


Specify the estimation you want to use in function `TAR` by parameter `method`, which can be

* "lse" (Iterated least squares), 
* "mle" (MLE under a structured covariance tensor)
* "projection" (Projection method)
* "ar" (stacked VAR(1) model). 

And specify you want to use multiple term model or one term model by parameter `r`. For example, if we want to estimate by LSE method under multiple term model with number of terms $r=2$, run as follows,

```{r, eval=FALSE}
model = TenAR(xx, r=2, method="lse")
```

The return of this function includes,

* `A` (estimator of coefficient matrices), 
* `res` (residual of the model), 
* `Sig` (covariance matrix cov(vec(E_t))), 

and other parameters depends on the method you used. These parameters are storage in the form of a list, so you can use `$` to extract them,

```{r, eval=FALSE}
A.estimate = model$A
residual = model$res
Sigma = model$Sig
```

## Prediction

There is a function `predict.tenar` for predictions. We offered a number of parameters, 

* `object` a fit from TenAR()
* `data` data to which to apply the prediction.
* `n.head` number of steps ahead at which to predict.
* `sd` logical: return standard errors of the prediction error. default is TRUE.
* `rolling` logical: use rolling forecast. default is TRUE.
* `method` method used by rolling forecast. default is "LSE".

```{r, eval=FALSE}
pred.xx <- predict.tenar(model, xx, n.head = 5)
```

## Plotting

We offered the function to plot the matrix-valued time series. This function can be applied to any mode of tensors. For example, we want to plot the second and third mode by given the fourth mode equals 1. By default, the order of first mode represents order of time.

```{r, fig.width=6,fig.height=4}
mplot(xx[,,,1])
```


## Discussion

- Our source code is now on https://github.com/ZeBang/timeFA. 
- If you have any problems or find any bugs please report on https://github.com/ZeBang/timeFA/issues. Thank you.

